<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas Mover</title>
    <style>
        canvas {
            margin: auto;
            text-align: center;
            border: 1px solid;
        }

        .debug {
            position: absolute;
        }
    </style>
</head>

<body>
    <div id="debug">
        <p>Control Method: Keyboard</p>
        <p>Use WASD</p>
        <p id="x">X-Position: 0</p>
        <p id="y">Y-Position: 0</p>
    </div>
    <canvas id="canvas" width="800" height="600"></canvas>


    <script>
        //helps define input and directional speed
        let up = 0;
        let down = 0;
        let right = 0;
        let left = 0;

        let xpos = document.getElementById("x");
        let ypos = document.getElementById("y");

        const canvas = document.getElementById("canvas");
        const ctx = canvas.getContext("2d");
        const player = {
            x: 0,
            y: 0,
            speed: 3,
            w: 50,
            h: 50,
            img: "blackSquare.png"
        }
        const img = new Image;
        img.src = player.img;
        img.onload = function () {
            ctx.drawImage(img, player.x, player.y, player.w, player.h)
        }

        document.addEventListener("keydown", function (event) {
            //sets the direction to 1, making it true
            let key = event.key;
            if (key == "w") {
                up = 1;
            } else if (key == "a") {
                left = 1;
            } else if (key == "s") {
                down = 1;
            } else if (key == "d") {
                right = 1;
            }
        });

        document.addEventListener("keyup", function (event) {
            //sets the direction to 0, making it false
            let key = event.key;
            if (key == "w") {
                up = 0;
            } else if (key == "a") {
                left = 0;
            } else if (key == "s") {
                down = 0;
            } else if (key == "d") {
                right = 0;
            }
        });

        function draw() {
            ctx.drawImage(img, player.x, player.y, player.w, player.h);
        }

        function update() {
            ctx.clearRect(0, 0, canvas.width, canvas.height)
            draw();

            let dx = 0; //diagonal x
            let dy = 0; //diagonal y

            if (up) {
                player.y -= player.speed * 1;
                dy -= 1;
            }

            if (down) {
                player.y += player.speed * 1;
                dy += 1;
            }

            if (left) {
                player.x -= player.speed * 1;
                dx -= 1;
            }

            if (right) {
                player.x += player.speed * 1;
                dx += 1;
            }

            //fixes diagonal movement becoming speedy
            if (dx !== 0 || dy !== 0) {
                let length = Math.sqrt(dx * dx + dy * dy);
                dx = (dx / length) * player.speed;
                dy = (dy / length) * player.speed
                player.x += dx;
                player.y += dy;
            }

            xpos.innerHTML = "X-Position: " + Math.round(player.x);
            ypos.innerHTML = "Y-Position: " + Math.round(player.y);

            if (player.x < 0) player.x = 0;
            if (player.y < 0) player.y = 0;
            if (player.x + player.w > canvas.width) player.x = canvas.width - player.w;
            if (player.y + player.h > canvas.height) player.y = canvas.height - player.h;

            requestAnimationFrame(update);
        }
        update();
    </script>
</body>

</html>